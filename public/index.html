<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HrmX Sync</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Socket.io with fallback -->
  <script>
    // Use try-catch for socket.io loading
    try {
      // When running in dev server
      document.write('<script src="/socket.io/socket.io.js"><\/script>');
    } catch (e) {
      console.warn('Error loading socket.io from server path, socket functions may be limited');
    }
  </script>
  <style>
    /* Hide scrollbars for all elements but maintain scroll functionality */
    * {
      -ms-overflow-style: none;
      /* Hide scrollbar for IE and Edge */
      scrollbar-width: none;
      /* Hide scrollbar for Firefox */
    }

    /* Hide scrollbar for Chrome, Safari and Opera */
    *::-webkit-scrollbar {
      display: none;
    }

    html,
    body {
      height: 100%;
      overflow: hidden;
      /* Prevent body scrolling */
    }

    /* Force tab content to take the full available height */
    .tab-content {
      display: none;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    .tab-content.active {
      display: flex;
      flex-direction: column;
    }

    /* Fix for dashboard layout */
    .dashboard-container {
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    .control-panel {
      flex-shrink: 0;
    }

    .logs-panel {
      flex-grow: 1;
      min-height: 0;
      /* Critical for flex containers */
      display: flex;
      flex-direction: column;
      margin-top: 1.5rem;
    }

    .logs-header {
      flex-shrink: 0;
    }

    /* Ensure scrollable containers actually scroll */
    .scroll-container {
      overflow-y: auto;
      overflow-x: hidden;
      min-height: 0;
      /* Critical for flex child items */
      flex-grow: 1;
      height: 100%;
      pointer-events: auto !important;
      touch-action: auto !important;
      -webkit-overflow-scrolling: touch;
    }

    /* Animation for log entries */
    .log-entry {
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body class="bg-gray-800 text-white flex flex-col h-full">
  <div class="flex flex-col h-full">
    <!-- App Header -->
    <header class="bg-gray-900 border-b border-gray-700 flex-shrink-0">
      <div class="container mx-auto px-4 py-4">
        <div class="flex justify-between items-center">
          <div class="flex items-center space-x-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
            <h1 class="text-2xl font-bold">HrmX Sync</h1>
          </div>
          <div id="status-badge" class="px-4 py-1 rounded-full bg-gray-700 text-sm font-medium">
            <span id="status-indicator" class="text-gray-400">Inactive</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Tab Navigation -->
    <div class="bg-gray-900 shadow-md flex-shrink-0">
      <div class="container mx-auto px-4">
        <div class="flex">
          <button id="dashboard-tab"
            class="tab-button px-5 py-3 text-red-400 border-b-2 border-red-500 font-medium">Home</button>
          <button id="settings-tab"
            class="tab-button px-5 py-3 text-gray-400 hover:text-white font-medium">Settings</button>
          <button id="devices-tab"
            class="tab-button px-5 py-3 text-gray-400 hover:text-white font-medium">Devices</button>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 flex flex-col overflow-hidden">
      <!-- Dashboard Tab Content -->
      <div id="dashboard-content" class="tab-content active">
        <div class="dashboard-container">
          <!-- Main Control Panel -->
          <div class="bg-gray-900 rounded-lg shadow-lg p-6 control-panel">
            <div class="flex flex-col items-center justify-center mb-6">
              <div id="status-circle"
                class="w-36 h-36 rounded-full flex items-center justify-center border-4 border-gray-700 mb-4">
                <div class="text-center">
                  <div id="sync-status-icon" class="text-5xl mb-2 text-gray-500">‚è∏</div>
                  <div id="sync-status-text" class="text-sm font-medium text-gray-400">Not Running</div>
                </div>
              </div>

              <button id="toggle-sync-btn"
                class="mt-4 px-8 py-3 bg-gray-600 hover:bg-gray-900 text-white font-medium rounded-lg shadow-lg flex items-center text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                    clip-rule="evenodd" />
                </svg>
                Start Sync
              </button>
            </div>

            <!-- Next Sync Info -->
            <div id="next-sync-info" class="hidden mb-6 text-center">
              <p class="text-gray-400">Next sync in: <span id="next-sync-time"
                  class="font-medium text-white">5:00</span>
                minutes</p>
            </div>
          </div>

          <!-- Logs Panel -->
          <div class="bg-gray-900 rounded-lg shadow-lg logs-panel">
            <div class="flex justify-between items-center p-4 border-b border-gray-800 logs-header">
              <h2 class="text-xl font-medium">Logs</h2>
              <div class="flex space-x-2">
                <button id="clear-logs" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm">
                  Clear
                </button>
                <button id="export-logs" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm">
                  Export
                </button>
              </div>
            </div>
            <div id="logs" class="p-4 bg-gray-950 text-sm font-mono scroll-container">
              <div class="text-gray-500">Waiting for sync to start...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings Tab Content -->
      <div id="settings-content" class="tab-content">
        <div class="bg-gray-900 rounded-lg shadow-lg p-6 flex flex-col h-full">
          <h2 class="text-xl font-medium mb-6 flex-shrink-0">Connection Settings</h2>

          <form id="settings-form" class="flex-grow scroll-container pr-2 -mr-2">
            <div class="space-y-6">
              <!-- Authentication Section -->
              <div class="space-y-4">
                <h3 class="text-lg font-medium text-red-400">Authentication</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label for="username" class="block text-sm font-medium text-gray-400 mb-1">Username</label>
                    <input type="text" id="username"
                      class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                  </div>
                  <div>
                    <label for="password" class="block text-sm font-medium text-gray-400 mb-1">Password</label>
                    <input type="password" id="password"
                      class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                  </div>
                </div>
              </div>

              <!-- Sync Configuration Section -->
              <div class="space-y-4">
                <h3 class="text-lg font-medium text-red-400">Sync Configuration</h3>
                <div>
                  <label for="sync-period" class="block text-sm font-medium text-gray-400 mb-1">Sync Period</label>
                  <select id="sync-period"
                    class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    <option value="5">Every 5 minutes</option>
                    <option value="10">Every 10 minutes</option>
                    <option value="30">Every 30 minutes</option>
                  </select>
                </div>
              </div>

              <!-- Server Configuration Section -->
              <div class="space-y-4">
                <!-- <h3 class="text-lg font-medium text-red-400">Server Configuration</h3> -->
                <div>
                  <label for="server-url" class="block text-sm font-medium text-gray-400 mb-1">Server URL</label>
                  <input type="text" id="server-url"
                    class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"
                    value="http://192.168.1.100:90">
                </div>
              </div>

              <div class="pt-4">
                <button type="submit" id="save-settings"
                  class="w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md shadow">
                  Save Settings
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- Devices Tab Content -->
      <div id="devices-content" class="tab-content">
        <div class="bg-gray-900 rounded-lg shadow-lg p-6 flex flex-col h-full">
          <div class="flex justify-between items-center mb-6 flex-shrink-0">
            <h2 class="text-xl font-medium">Devices & Company IDs</h2>
            <button id="refresh-devices"
              class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              Refresh
            </button>
          </div>

          <div id="devices-loading" class="flex-grow flex items-center justify-center">
            <div class="text-center">
              <svg class="animate-spin h-8 w-8 mx-auto text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
              </svg>
              <p class="mt-2 text-gray-400">Loading devices...</p>
            </div>
          </div>

          <div id="devices-error" class="flex-grow flex items-center justify-center hidden">
            <div class="text-center">
              <svg class="h-12 w-12 mx-auto text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="mt-2 text-red-400">Failed to load devices. Please check your connection.</p>
              <button id="retry-devices" class="mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md">Retry</button>
            </div>
          </div>

          <div id="devices-table-container" class="flex-grow flex flex-col hidden">
            <div class="scroll-container">
              <table class="w-full text-left">
                <thead>
                  <tr class="bg-gray-800">
                    <!-- <th class="px-4 py-2 rounded-tl-lg">ID</th> -->
                    <th class="px-4 py-2">IP Address</th>
                    <th class="px-4 py-2 rounded-tr-lg">Company ID</th>
                  </tr>
                </thead>
                <tbody id="devices-table-body">
                  <!-- Devices will be populated here -->
                </tbody>
              </table>

              <div class="mt-6 text-sm text-gray-500">
                <p>Note: Company IDs are used to associate devices with specific company departments or branches.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- App Footer -->
    <footer class="bg-gray-900 border-t border-gray-800 flex-shrink-0">
      <div class="container mx-auto px-4 py-3">
        <div class="flex justify-between items-center">
          <div class="text-sm text-gray-500">
            RedCodex ¬© 2025
          </div>
          <div class="text-sm text-gray-500">
            V1.0.0
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script src="./js/app.js"></script>
</body>

</html>